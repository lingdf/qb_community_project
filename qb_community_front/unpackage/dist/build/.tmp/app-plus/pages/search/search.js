(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/search/search"],{2311:function(e,t,n){"use strict";n.r(t);var r=n("b04a"),a=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t["default"]=a.a},"323e":function(e,t,n){"use strict";n.r(t);var r=n("4c38"),a=n("2311");for(var i in a)"default"!==i&&function(e){n.d(t,e,function(){return a[e]})}(i);var s=n("2877"),o=Object(s["a"])(a["default"],r["a"],r["b"],!1,null,null,null);t["default"]=o.exports},"4c38":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement;e._self._c},a=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a})},"9af5":function(e,t,n){"use strict";(function(e){n("78d4"),n("921b");r(n("66fd"));var t=r(n("323e"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},b04a:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(n("a34a"));function a(e){return e&&e.__esModule?e:{default:e}}function i(e,t){return u(e)||o(e,t)||s()}function s(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function o(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done);r=!0)if(n.push(s.value),t&&n.length===t)break}catch(u){a=!0,i=u}finally{try{r||null==o["return"]||o["return"]()}finally{if(a)throw i}}return n}function u(e){if(Array.isArray(e))return e}function c(e,t,n,r,a,i,s){try{var o=e[i](s),u=o.value}catch(c){return void n(c)}o.done?t(u):Promise.resolve(u).then(r,a)}function l(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function s(e){c(i,r,a,s,o,"next",e)}function o(e){c(i,r,a,s,o,"throw",e)}s(void 0)})}}var h=function(){return n.e("components/index/card-list").then(n.bind(null,"b79b"))},d=function(){return n.e("components/common/no-thing").then(n.bind(null,"35b5"))},f=function(){return n.e("components/common/load-more").then(n.bind(null,"87e2"))},p=function(){return n.e("components/news/hot-list").then(n.bind(null,"1834"))},m=function(){return n.e("components/user-list/friend-list").then(n.bind(null,"f9e5"))},v={components:{cardList:h,noThing:d,loadMore:f,hotList:p,friendList:m},data:function(){return{isSearch:!1,loadMoreText:"上拉加载更多",list:[],searchText:"",page:1,searchType:""}},onLoad:function(t){if(t){if(this.searchType=t.searchType||"post","topic"==this.searchType){var n=this.$mp.page.$getAppWebview(),r=n.getStyle().titleNView;r.searchInput.placeholder="搜索话题",n.setStyle({titleNView:r})}else if("user"==this.searchType){var a=this.$mp.page.$getAppWebview(),i=a.getStyle().titleNView;i.searchInput.placeholder="搜索用户",a.setStyle({titleNView:i})}e.$on("updateData",this.updateDate)}},onNavigationBarButtonTap:function(t){0==t.index&&e.navigateBack({delta:1})},onNavigationBarSearchInputChanged:function(e){this.searchText=e.text},onNavigationBarSearchInputConfirmed:function(e){e.text&&this.searchData()},onReachBottom:function(){this.loadMore()},onPullDownRefresh:function(){this.searchData(),e.stopPullDownRefresh()},methods:{searchData:function(){var t=l(r.default.mark(function t(){return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:e.showLoading({title:"Loading...",mask:!0}),this.list=[],this.getList();case 3:case"end":return t.stop()}},t,this)}));function n(){return t.apply(this,arguments)}return n}(),getList:function(){var t=l(r.default.mark(function t(){var n,a,s,o,u,c,l,h,d,f,p,m;return r.default.wrap(function(t){while(1)switch(t.prev=t.next){case 0:t.t0=this.searchType,t.next="post"===t.t0?3:"topic"===t.t0?5:"user"===t.t0?7:8;break;case 3:return n="search/searchPost",t.abrupt("break",8);case 5:return n="search/searchTopic",t.abrupt("break",8);case 7:n="search/searchUser";case 8:return t.next=10,this.$http.post(n,{keyword:this.searchText,page:this.page,user_id:this.User.userinfo.id});case 10:if(a=t.sent,s=i(a,2),o=s[0],u=s[1],o){t.next=46;break}if(c=u.data,e.hideLoading(),200!=c.code){t.next=43;break}if(!c.data.length){t.next=41;break}for(l=!0,h=!1,d=void 0,t.prev=22,f=c.data[Symbol.iterator]();!(l=(p=f.next()).done);l=!0)m=p.value,this.list.push(this.listFormat(m));t.next=30;break;case 26:t.prev=26,t.t1=t["catch"](22),h=!0,d=t.t1;case 30:t.prev=30,t.prev=31,l||null==f.return||f.return();case 33:if(t.prev=33,!h){t.next=36;break}throw d;case 36:return t.finish(33);case 37:return t.finish(30);case 38:e.hideLoading(),t.next=43;break;case 41:this.isSearch=!0,e.hideLoading();case 43:c.data.length<10?this.loadMoreText="没有更多数据了~":this.loadMoreText="上拉加载更多~",t.next=47;break;case 46:e.showToast({title:"网络开小差啦~"});case 47:e.hideLoading();case 48:case"end":return t.stop()}},t,this,[[22,26,30,38],[31,,33,37]])}));function n(){return t.apply(this,arguments)}return n}(),loadMore:function(){"上拉加载更多~"==this.loadMoreText&&(this.loadMoreText="加载中...",this.page++,this.getList())},listFormat:function(e){switch(this.searchType){case"post":return{id:e.id,user_id:e.user_id,uname:e.user[0].username,uimg:e.user[0].userpic,isFocus:e.fans.length,title:e.title,titimg:e.titlepic,content:e.content,age:e.user[0].age,sex:e.user[0].sex,path:e.user[0].path,type:e.type,post_class_id:e.post_class_id,isopen:e.isopen,infonum:{index:e.support?e.support.type+1:0,upnum:11,downnum:11},imgList:e.imgList,fans:e.fans,commentnum:10,share:e.sharenum};case"topic":return{id:e.id,titleimg:e.titlepic,title:"#".concat(e.title,"#"),introduce:e.desc,totalnum:942,todaynum:196};case"user":return{id:e.id,uimg:e.userpic,uname:e.username,sex:e.userinfo.sex,age:e.userinfo.age}}},updateDate:function(e){switch(e.type){case"onFocus":this.updateFocus(e);break}},updateFocus:function(e){var t=!0,n=!1,r=void 0;try{for(var a,i=this.list[Symbol.iterator]();!(t=(a=i.next()).done);t=!0){var s=a.value;s.user_id==e.user_id&&(s.isFocus=e.data)}}catch(o){n=!0,r=o}finally{try{t||null==i.return||i.return()}finally{if(n)throw r}}}}};t.default=v}).call(this,n("6e42")["default"])}},[["9af5","common/runtime","common/vendor"]]]);